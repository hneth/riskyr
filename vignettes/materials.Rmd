---
title: "`riskyr` Materials"
author: "Hansjörg Neth"
date: "`r Sys.Date()`"
output: 
  rmarkdown::html_vignette: 
    fig_caption: yes
vignette: >
  %\VignetteIndexEntry{Materials}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```


Note: This file contains snippets of older materials yet to be used in actual vignettes.


## Motivation

A basic motivation for developing `riskyr` was to facilitate the understanding of problems concering so-called Bayesian reasoning. Such problems tend to appear in texts and tutorials on risk literacy and are ubiquitous in medical diagnostics. A typical example reads as follows:

> The probability of breast cancer is 1% for a woman at age 40 who participates in routine screening.  
> If a woman has breast cancer, the probability is 80% that she will get a positive mammography.  
> If a woman does not have breast cancer, the probability is 9.6% that she will also get a positive mammography.  
> 
> A woman in this age group had a positive mammography in a routine screening. What is the probability that she actually has breast cancer?    
> 
> (Hoffrage et al., 2015, p. 3)  

Problems of this type tend to provide three probabilities:

1. the prevalence `prev` of some condition $C$;  
2. the sensitivity `sens` of some decision $D$ (e.g., the outcome of some test or diagnostic procedure); 
3. the specificity `spec` of $D$;

and ask for one or more other probabilities:

- the probability of a positive (or negative) decision; 
- the positive predictive value `PPV` of $D$;  
- the negative predictive value `NPV` of $D$. 

Standard observation: People are confused and perplexed. Frequently, they even find it difficult to understand the question, let alone have a systematic way of answering it. In a majority of cases, they either have no clue what to respond, or provide some number close to the provided values `sens` or `spec` as a rough estimate.

Importantly, the calculations involved are easy -- almost trivial -- and do only require simple sums, products, and ratios. What's lacking is a systematic way of thinking about such problems and to see how probabilistic notions can be defined and be translated into more manageable information formats (frequencies and ratios between frequencies). The main mission of `riskyr` is to help people to understand this interplay of probabilities and frequencies and thus render risk-related information more transparent.


## Basic Knowledge on Probabilities

Here are a few basic facts that a risk-literate person should know when dealing with probabilities:

- Probabilities are _numbers_ that describe the likelihood of some event. Their value can be expressed as and defined in terms of _ratios_ (e.g., the probability of today being Monday is $p(\mathrm{Monday}) = \frac{1}{7}$). When expressed as decimal numbers, probabilites are numbers in the range from 0 to 1 (e.g., $p(\mathrm{Monday}) = \frac{1}{7}~=~$ `r 1/7`.).

- If an event $E$ has a probability of $p$, the probability of $not~E$ (sometimes denoted as $\neg{E}$ or $\bar{E}$) has a value of $p(\neg{E}) = 1 - p$ and is called the _complement_ of $p$.

- _Conditional_ probabilities $p(D|E)$ are typically _not_ reversable: In fact, $p(D|E)$ is often very different from $p(E|D)$. An example illustrates the difference: The probability $p(male|king)$ that a biblical king is male is high. Nevertheless, the probability that a male person is a biblical king $p(king|male)$ is low.

- The numeric value of a conditional probability can be computed with _Bayes' formula_ (see our [user guide](user_guide.html)) or in terms of _natural frequencies_. For humans, the former is difficult, the latter simpler and more transparent.


## Confusion Matrix

Confusion matrix: Ordinary people and experts struggle alike: aptly-named "confusion matrix": Each measure is simple, but the matter is complex in the abundance of metrics (see examples) and their inter-dependence. 

Behold the aptly named "confusion" matrix: 


|         | Condition           |     | 
| ------:  |:----:|:----:|------:|              
| **Decision** | `TRUE`:      | `FALSE`:      |     Sum:  | 
| positive:      | `hi`       | `fa`          | `dec.pos` | 
| negative:      | `mi`       | `cr`          | `dec.neg` | 
|      Sum:      | `cond.true` | `cond.false` |       `N` |



### Terminology

Ordinary people and experts struggle alike: aptly-named "confusion matrix". Measures are simple, but complex in their abundance (see examples) and inter-dependence.

The 4 cells are the essential core of all metrics.

Identify 2 correct cases (`hi`, `cr`) and 2 errors (`mi`, `fa`).

Sources of confusion: 

- `mi` are in the `cond.true` column (left), but "false negatives".
- `cr` are in the `cond.false` column (right), but "true negatives".

Thus, the terms "false" and "true" in cell names refer to the relationship between or correspondence of condition and decision, rather than the condition alone.


### Relationships

1. The 2 columns of the confusion table:

$$ 
\begin{aligned}
\texttt{cond.true}  &= \texttt{hi} + \texttt{mi} \\
\texttt{cond.false} &= \texttt{fa} + \texttt{cr} \\
\end{aligned}
$$ 

2. The 2 rows of the confusion table:

$$ 
\begin{aligned}
\texttt{dec.pos}  &= \texttt{hi} + \texttt{fa} \\
\texttt{dec.neg}  &= \texttt{mi} + \texttt{cr} \\
\end{aligned}
$$ 



3. The 2 diagonals of the confusion table:

$$ 
\begin{aligned}
\texttt{dec.cor}      &= \texttt{hi} + \texttt{cr} \\
\texttt{dec.err}      &= \texttt{mi} + \texttt{fa} \\
\end{aligned}
$$ 

Note that these are often called "true decisions" and "false decisions", but this promotes confusion, as "true decisions" include `cond.false` cases (`cr`) and false decisions include `cond.true` cases (`mi`).


4. Overall, the following relationships hold among the frequencies:

$$ 
\begin{aligned}
\texttt{N} &= \texttt{dec.pos} + \texttt{dec.neg}      \\
           &= \texttt{cond.true} + \texttt{cond.false} \\
           &= \texttt{dec.cor} + \texttt{dec.err}      \\
           &= \texttt{hi} + \texttt{mi} + \texttt{fa} + \texttt{cr} \\
\end{aligned}
$$ 


## Accuracy Metrics

1. Accuracy: Proportion or percentage of cases correctly classified.

$$
\begin{aligned}
\texttt{acc} &= \frac{\texttt{hi} + \texttt{cr}}{\texttt{hi} + \texttt{mi} + \texttt{fa} + \texttt{cr}} 
             = \frac{\texttt{dec.cor}}{\texttt{dec.cor} + \texttt{dec.err}} = \frac{\texttt{dec.cor}}{\texttt{N}}  
\end{aligned}
$$

2. Weighted accuracy: Taking into account the importance of errors.

3. Matthew correlation coefficient (mcc)



## All References

- Gigerenzer, G. (2002). 
_Reckoning with risk: Learning to live with uncertainty_. 
London, UK: Penguin.

- Gigerenzer, G. (2014). 
_Risk savvy: How to make good decisions_. 
New York, NY: Penguin.

- Gigerenzer, G., Gaissmaier, W., Kurz-Milcke, E., Schwartz, L., & Woloshin, S. (2007). 
Helping doctors and patients make sense of health statistics. 
_Psychological Science in the Public Interest_, _8_, 53--96.

- Gigerenzer, G., & Hoffrage, U. (1995). 
How to improve Bayesian reasoning without instruction: Frequency formats. 
_Psychological Review_, _102_, 684--704.

- Gigerenzer, G., & Hoffrage, U. (1999). 
Overcoming difficulties in Bayesian reasoning: A reply to Lewis and Keren (1999) and Mellers and McGraw (1999). 
_Psychological Review_, _106_, 425--430.

- Hájek, A (2012) [Interpretations of Probability](https://plato.stanford.edu/entries/probability-interpret/). 
In Edward N. Zalta (Ed.), _The Stanford Encyclopedia of Philosophy_. 
URL: https://plato.stanford.edu/entries/probability-interpret/ [2012 Archive](https://plato.stanford.edu/archives/win2012/entries/probability-interpret/) 

- Hertwig, R., & Grüne-Yanoff, T. (2017). 
Nudging and boosting: Steering or empowering good decisions. 
_Perspectives on Psychological Science_, _12_, 973--986.

- Hoffrage, U., Gigerenzer, G., Krauss, S., & Martignon, L. (2002). 
Representation facilitates reasoning: What natural frequencies are and what they are not. 
_Cognition_, _84_, 343--352.

- Hoffrage, U., Krauss, S., Martignon, L., & Gigerenzer, G. (2015). 
Natural frequencies improve Bayesian reasoning in simple and complex inference tasks. 
_Frontiers in Psychology_, _6_, 1473.

- Hoffrage, U., Lindsey, S., Hertwig, R., & Gigerenzer, G. (2000). 
Communicating statistical information. 
_Science_, _290_, 2261--2262.

- Phillips, N. D., Neth, H., Woike, J. K., & Gaissmaier, W. (2017). 
FFTrees: A toolbox to create, visualize, and evaluate fast-and-frugal decision trees. 
_Judgment and Decision Making_, _12_, 344--368. 
[ [pdf](http://journal.sjdm.org/17/17217/jdm17217.pdf) | [html](http://journal.sjdm.org/17/17217/jdm17217.html) | [R package](https://CRAN.R-project.org/package=FFTrees) ]

- Kurzenhäuser, S., & Hoffrage, U. (2002). 
Teaching Bayesian reasoning: An evaluation of a classroom tutorial for medical students. 
_Medical Teacher_, _24_, 516--521.

- Kurz-Milcke, E., Gigerenzer, G., & Martignon, L. (2008). 
Transparency in risk communication. 
_Annals of the New York Academy of Sciences_, _1128_, 18--28.

- Sedlmeier, P., & Gigerenzer, G. (2001). 
Teaching Bayesian reasoning in less than two hours. 
_Journal of Experimental Psychology: General_, _130_, 380--400.


## All `riskyr` Vignettes

- [User guide](user_guide.html)
- [Data formats](data_formats.html)
- [Confusion matrix](confusion_matrix.html)

<!-- eof. -->


# Template

Vignettes are long form documentation commonly included in packages. Because they are part of the distribution of the package, they need to be as compact as possible. The `html_vignette` output type provides a custom style sheet (and tweaks some options) to ensure that the resulting html is as small as possible. The `html_vignette` format:

- Never uses retina figures
- Has a smaller default figure size
- Uses a custom CSS stylesheet instead of the default Twitter Bootstrap style

## Vignette Info

Note the various macros within the `vignette` section of the metadata block above. These are required in order to instruct R how to build the vignette. Note that you should change the `title` field and the `\VignetteIndexEntry` to match the title of your vignette.

## Styles

The `html_vignette` template includes a basic CSS theme. To override this theme you can specify your own CSS in the document metadata as follows:

    output: 
      rmarkdown::html_vignette:
        css: mystyles.css

## Figures

The figure sizes have been customised so that you can easily put two images side-by-side. 

```{r, fig.show='hold'}
plot(1:10)
plot(10:1)
```

You can enable figure captions by `fig_caption: yes` in YAML:

    output:
      rmarkdown::html_vignette:
        fig_caption: yes

Then you can use the chunk option `fig.cap = "Your figure caption."` in **knitr**.

## More Examples

You can write math expressions, e.g. $Y = X\beta + \epsilon$, footnotes^[A footnote here.], and tables, e.g. using `knitr::kable()`.

```{r, echo=FALSE, results='asis'}
knitr::kable(head(mtcars, 10))
```

Also a quote using `>`:

> "He who gives up [code] safety for [code] speed deserves neither."
([via](https://twitter.com/hadleywickham/status/504368538874703872))
